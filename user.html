<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Computer Science Test</title>
    <link rel="shortcut icon" href="assets/logo.png" type="image/x-icon" />
    <link rel="stylesheet" href="assets/css/head.css" />
    <link rel="stylesheet" href="assets/css/homepage.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@48,400,0,0"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Include the Netlify Identity script -->
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-GJ5DVQ4B4H"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-GJ5DVQ4B4H");
    </script>
  </head>

  <body>
    <header class="header">
      <a href="" class="logo"
        ><img class="logo" src="assets/logo.png" alt="Huto Logo" /> Computer
        Science Test</a
      >
      <div class="header-right">
        <a href="signup">Sign up</a>
        <a href="announcements">Announcements</a>
        <a href="//hutoorg.github.io/contact-us">Contact</a>
      </div>
    </header>

    <div class="userpage">
      <!-- Add a link to the admin page in your navigation -->
      <a href="/admin/">Admin</a>

      <!-- Create an admin page that will only be accessible to logged in users -->
      <div id="app"></div>

      <script>
        // Initialize Netlify Identity
        if (window.netlifyIdentity) {
          netlifyIdentity.on("init", (user) => {
            if (!user) {
              netlifyIdentity.on("login", () => {
                document.location.href = "/admin/";
              });
            } else {
              // Render the user page
              renderUserPage(user);
            }
          });
        }

        // Listen for when a user is logged in
        if (window.netlifyIdentity) {
          window.netlifyIdentity.on("login", (user) => {
            document.location.href = "/admin/";
          });
        }

        // Render the user page
        function renderUserPage(user) {
          // Get the user's email
          const email = user.email;

          // Create the user page
          const app = document.getElementById("app");
          app.innerHTML = `
            <h1>Welcome, ${email}!</h1>
            <p>This is your user page.</p>
            <button onclick="logout()">Logout</button>
          `;
        }

        // Logout function
        function logout() {
          if (window.netlifyIdentity) {
            window.netlifyIdentity.logout();
          }
        }
      </script>
    </div>
    <script src="assets/js/homepage.js"></script>
    <script src="assets/js/console_logging.min.js"></script>
    <script
      src="//code.tidio.co/wfrcyhlps6zxndzrhxfkfsl5imzvmabz.js"
      async
    ></script>
  </body>
</html>
